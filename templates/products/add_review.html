{% extends 'base.html' %}
{% load static %}

{% block title %}Review {{ product.name }} - SkinSense{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
<style>
    .review-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 60px 0;
        margin-bottom: 40px;
    }
    
    .form-card {
        background: white;
        border-radius: 15px;
        padding: 40px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    
    .product-preview {
        background: #f8f9fa;
        border-radius: 15px;
        padding: 25px;
        text-align: center;
        margin-bottom: 30px;
    }
    
    .form-label {
        font-weight: 600;
        color: #667eea;
        margin-bottom: 8px;
    }
    
    .form-control, .form-select {
        border-radius: 10px;
        border: 2px solid #e0e0e0;
        padding: 12px;
        transition: all 0.3s;
    }
    
    .form-control:focus, .form-select:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
    }
    
    .rating-input {
        display: flex;
        gap: 10px;
        flex-direction: row-reverse;
        justify-content: flex-end;
    }
    
    .rating-input input[type="radio"] {
        display: none;
    }
    
    .rating-input label {
        font-size: 2rem;
        cursor: pointer;
        color: #ddd;
        transition: color 0.2s;
    }
    
    .rating-input input[type="radio"]:checked ~ label,
    .rating-input label:hover,
    .rating-input label:hover ~ label {
        color: #ffd700;
    }
    
    .range-slider {
        width: 100%;
    }
    
    .range-value {
        display: inline-block;
        padding: 5px 15px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 20px;
        font-weight: bold;
        margin-left: 10px;
    }
    
    .btn-submit {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        color: white;
        padding: 15px 50px;
        border-radius: 25px;
        transition: all 0.3s;
        font-weight: bold;
        font-size: 1.1rem;
    }
    
    .btn-submit:hover {
        background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        color: white;
        transform: scale(1.05);
    }
    
    .info-box {
        background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 30px;
        border-left: 4px solid #667eea;
    }
</style>
{% endblock %}

{% block content %}
<!-- Header -->
<div class="review-header animate__animated animate__fadeIn">
    <div class="container text-center">
        <h1 class="display-4 fw-bold mb-3">üìù Write a Review</h1>
        <p class="lead">Share your experience with this product</p>
    </div>
</div>

<!-- Form -->
<div class="container mb-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <!-- Product Preview -->
            <div class="product-preview animate__animated animate__fadeInDown">
                {% if product.image %}
                <img src="{{ product.image.url }}" alt="{{ product.name }}" 
                     style="height: 150px; object-fit: contain; margin-bottom: 15px;">
                {% else %}
                <div style="font-size: 5rem; margin-bottom: 15px;">üß¥</div>
                {% endif %}
                <h3>{{ product.name }}</h3>
                <p class="text-muted mb-0">{{ product.skin_type }} ‚Ä¢ {{ product.get_category_display }}</p>
            </div>
            
            {% if existing_review %}
            <div class="alert alert-warning animate__animated animate__fadeIn">
                <strong>‚ö†Ô∏è You've already reviewed this product!</strong>
                <p class="mb-0">You can view your review in the community hub.</p>
                <a href="{% url 'community_hub' %}" class="btn btn-sm btn-primary mt-2">Go to Community Hub</a>
            </div>
            {% else %}
            
            <div class="info-box animate__animated animate__fadeInUp">
                <h5>üí° Tips for Writing a Great Review</h5>
                <ul class="mb-0">
                    <li>Be honest about your experience</li>
                    <li>Mention specific results you noticed</li>
                    <li>Include how long you've used the product</li>
                    <li>Note any pros and cons</li>
                </ul>
            </div>
            
            <div class="form-card animate__animated animate__fadeInUp">
                <form method="post" action="{% url 'add_review' product.id %}" id="reviewForm">
                    {% csrf_token %}
                    
                    <!-- Overall Rating -->
                    <div class="mb-4">
                        <label class="form-label">Overall Rating *</label>
                        <div class="rating-input" id="overallRating">
                            <input type="radio" name="rating" value="5" id="star5" required>
                            <label for="star5">‚≠ê</label>
                            <input type="radio" name="rating" value="4" id="star4">
                            <label for="star4">‚≠ê</label>
                            <input type="radio" name="rating" value="3" id="star3">
                            <label for="star3">‚≠ê</label>
                            <input type="radio" name="rating" value="2" id="star2">
                            <label for="star2">‚≠ê</label>
                            <input type="radio" name="rating" value="1" id="star1">
                            <label for="star1">‚≠ê</label>
                        </div>
                    </div>
                    
                    <!-- Review Title -->
                    <div class="mb-4">
                        <label for="title" class="form-label">Review Title *</label>
                        <input type="text" class="form-control" id="title" name="title" 
                               placeholder="e.g., Amazing results for sensitive skin!" required>
                    </div>
                    
                    <!-- Review Text -->
                    <div class="mb-4">
                        <label for="review_text" class="form-label">Your Review *</label>
                        <textarea class="form-control" id="review_text" name="review_text" rows="6" 
                                  placeholder="Share your detailed experience with this product..." required></textarea>
                    </div>
                    
                    <!-- Skin Type -->
                    <div class="mb-4">
                        <label for="skin_type" class="form-label">Your Skin Type *</label>
                        <select class="form-select" id="skin_type" name="skin_type" required>
                            <option value="">Select your skin type</option>
                            <option value="oily">Oily</option>
                            <option value="dry">Dry</option>
                            <option value="combination">Combination</option>
                            <option value="sensitive">Sensitive</option>
                            <option value="normal">Normal</option>
                        </select>
                    </div>
                    
                    <!-- Effectiveness -->
                    <div class="mb-4">
                        <label for="effectiveness" class="form-label">
                            Effectiveness <span class="range-value" id="effectivenessValue">3</span>
                        </label>
                        <input type="range" class="form-range range-slider" id="effectiveness" 
                               name="effectiveness" min="1" max="5" value="3" 
                               oninput="document.getElementById('effectivenessValue').textContent = this.value">
                    </div>
                    
                    <!-- Value for Money -->
                    <div class="mb-4">
                        <label for="value_for_money" class="form-label">
                            Value for Money <span class="range-value" id="valueValue">3</span>
                        </label>
                        <input type="range" class="form-range range-slider" id="value_for_money" 
                               name="value_for_money" min="1" max="5" value="3" 
                               oninput="document.getElementById('valueValue').textContent = this.value">
                    </div>
                    
                    <!-- Usage Duration -->
                    <div class="mb-4">
                        <label for="usage_duration" class="form-label">How long have you used this product? *</label>
                        <select class="form-select" id="usage_duration" name="usage_duration" required>
                            <option value="">Select duration</option>
                            <option value="Less than 1 week">Less than 1 week</option>
                            <option value="1-2 weeks">1-2 weeks</option>
                            <option value="1 month">1 month</option>
                            <option value="2-3 months">2-3 months</option>
                            <option value="3-6 months">3-6 months</option>
                            <option value="6+ months">6+ months</option>
                            <option value="1+ year">1+ year</option>
                        </select>
                    </div>
                    
                    <!-- Would Recommend -->
                    <div class="mb-4">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="would_recommend" 
                                   id="would_recommend" checked>
                            <label class="form-check-label" for="would_recommend">
                                <strong>I would recommend this product to others</strong>
                            </label>
                        </div>
                    </div>
                    
                    <hr class="my-4">
                    
                    <!-- Submit -->
                    <div class="text-center">
                        <button type="submit" class="btn btn-submit">
                            üöÄ Publish Review
                        </button>
                        <div class="mt-3">
                            <a href="{% url 'community_hub' %}" class="text-muted">Cancel and go back</a>
                        </div>
                    </div>
                </form>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
